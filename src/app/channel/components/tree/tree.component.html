<ul *ngIf="tree && tree.length" class="list-unstyled w-100 d-flex flex-column">
	<li *ngFor="let branch of tree" class="w-100 pl-2 d-flex flex-column">
		<span
			class="d-flex align-items-center justify-content-between py-1 px-2 {{
				'over-' + types[branch.path]
			}}"
			[class.selected]="isSelected(branch)"
		>
			<span
				class="w-100 flex-shrink-1 d-flex align-items-center"
				(click)="onSelectBranch(branch); isOpen[branch.path] = true"
			>
				<div class="mr-1 {{ 'color-' + types[branch.path] }}">
					<mat-icon
						*ngIf="branch.children.length && isOpen[branch.path]"
						[inline]="true"
						>folder_open</mat-icon
					>
					<mat-icon
						*ngIf="branch.children.length && !isOpen[branch.path]"
						[inline]="true"
						>folder</mat-icon
					>
					<mat-icon *ngIf="!branch.children.length" [inline]="true"
						>insert_drive_file</mat-icon
					>
				</div>
				{{ branch.name }}
			</span>
			<mat-icon
				*ngIf="branch.children.length"
				color="primary"
				class="flex-shrink-0"
				(click)="isOpen[branch.path] = !isOpen[branch.path]"
			>
				{{
					isOpen[branch.path]
						? 'keyboard_arrow_down'
						: 'keyboard_arrow_left'
				}}
			</mat-icon>
		</span>
		<app-channel-tree
			[selectedPath]="selectedPath"
			[rootPath]="
				rootPath.length ? rootPath + '/' + branch.path : branch.path
			"
			class="d-flex flex-column"
			[class.openned]="isOpen[branch.path]"
			[tree]="branch.children"
			(selectBranch)="onSelectBranch($event)"
			(addTemplate)="addTemplate.emit($event)"
		></app-channel-tree>
	</li>
	<li class="w-100 pl-2 d-flex flex-column">
		<span
			class="d-flex align-items-center justify-content-between py-1 px-2"
		>
			<div class="d-flex align-items-center w-100 flex-shrink-1">
				<span
					(click)="newpath.focus()"
					style="cursor:pointer;"
					class="mr-1"
					[matTooltip]="'tree_add_new_path_tooltip' | translate"
				>
					<mat-icon [inline]="true" color="primary">add</mat-icon>
				</span>
				<input
					[(ngModel)]="newTemplatePath"
					[placeholder]="'tree_add_new_path_placeholder' | translate"
					class="inline-input w-100 flex-shrink-1 mr-2"
					type="text"
					#newpath
					(change)="newpath.value.length ? onAddTemplate() : false"
				/>
			</div>
			<span
				(click)="onAddTemplate()"
				*ngIf="newpath.value.length"
				class="flex-shrink-0"
				style="cursor:pointer;"
			>
				<mat-icon [inline]="true" color="primary"
					>keyboard_return
				</mat-icon>
			</span>
		</span>
	</li>
</ul>
