<div [formGroup]="form">
    <div class="mb-2">
        <div class="row">
            <div class="col-md-8">
                <div class="input-cnt">
                    <input formControlName="name" class="form-control" [(ngModel)]="template.name" type="text">
                    <div
                            *ngIf="form.controls['name'].invalid && (form.controls['name'].dirty || form.controls['name'].touched)"
                            class="alert alert-danger mt-2">
                        <div *ngIf="form.controls['name'].errors.required">
                            {{ 'error_name_required' | translate }}
                        </div>
                        <div *ngIf="form.controls['name'].errors.pattern && !form.controls['name'].errors.required">
                            {{ 'error_name_format' | translate }}
                        </div>
                        <div *ngIf="form.controls['name'].errors.minlength">
                            {{ 'error_name_min_length' | translate:translateParams }}
                        </div>
                        <div *ngIf="form.controls['name'].errors.maxlength">
                            {{ 'error_name_max_length' | translate:translateParams }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 text-md-right mt-1 mt-md-0">
                <button *ngIf="!showCode" type="button" class="btn btn-outline-secondary" (click)="showCode=true">
                    {{ 'template_show' | translate }}
                </button>
                <button *ngIf="showCode" type="button" class="btn btn-secondary" (click)="showCode=false">
                    {{ 'template_hide' | translate }}
                </button>
            </div>
        </div>
    </div>
    <div *ngIf="showCode" class="mb-2">
        <div class="row">
            <div class="col-md-6">
                <div class="input-cnt">
                    <input formControlName="path" class="form-control" [(ngModel)]="template.path" type="text">
                    <div
                            *ngIf="form.controls['path'].invalid && (form.controls['path'].dirty || form.controls['path'].touched)"
                            class="alert alert-danger mt-2">
                        <div *ngIf="form.controls['path'].errors.required">
                            {{ 'error_path_required' | translate }}
                        </div>
                        <div *ngIf="form.controls['path'].errors.pattern && !form.controls['path'].errors.required">
                            {{ 'error_path_format' | translate }}
                        </div>
                        <div *ngIf="form.controls['path'].errors.minlength">
                            {{ 'error_path_min_length' | translate:translateParams }}
                        </div>
                        <div *ngIf="form.controls['path'].errors.maxlength">
                            {{ 'error_path_max_length' | translate:translateParams }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mt-2 mt-md-0">
                <select formControlName="engine" class="form-control" [(ngModel)]="template.engine">
                    <option disabled>{{ 'template_engine' | translate }}</option>
                    <option *ngFor="let engine of engines" [ngValue]="engine.value">{{engine.name}}</option>
                </select>
                <div
                        *ngIf="form.controls['engine'].invalid && (form.controls['engine'].dirty || form.controls['engine'].touched)"
                        class="alert alert-danger mt-2">
                    <div *ngIf="form.controls['engine'].errors.required">
                        {{ 'error_engine_required' | translate }}
                    </div>
                    <div *ngIf="form.controls['engine'].errors.pattern && !form.controls['engine'].errors.required">
                        {{ 'error_engine_value' | translate }}
                    </div>
                </div>
            </div>
            <div class="col-md-3 mt-2 mt-md-0">
                <select formControlName="input" class="form-control" [(ngModel)]="template.input">
                    <option disabled>{{ 'template_input' | translate }}</option>
                    <option *ngFor="let input of inputs" [ngValue]="input.value">{{input.name |Â translate}}</option>
                </select>
                <div
                        *ngIf="form.controls['input'].invalid && (form.controls['input'].dirty || form.controls['input'].touched)"
                        class="alert alert-danger mt-2">
                    <div *ngIf="form.controls['input'].errors.required">
                        {{ 'error_input_required' | translate }}
                    </div>
                    <div *ngIf="form.controls['input'].errors.pattern && !form.controls['input'].errors.required">
                        {{ 'error_input_value' | translate }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="showCode">
        <div class="row">
            <div class="col-lg-12">
                <div class="template-preview">
                    <pre class="m-0 bg-light p-3 rounded"><code>{{ template.content }}</code></pre>
                    <div class="open-overlay d-flex align-items-center justify-content-center">
                        <button type="button" class="btn btn-outline-primary" (click)="onShowEditor();">
                            {{ 'template_open_editor' | translate }}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="showEditor">
        <app-channel-editor
                [pathMaxLength]="maxLength"
                [pathMinLength]="minlength"
                [template]="template"
                (onSave)="onEditorSave()"
                (onCancel)="onEditorCancel()">
        </app-channel-editor>
    </div>
</div>
