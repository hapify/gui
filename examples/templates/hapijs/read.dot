<script>
'use strict';
/**
 * Read {{=it.m.names.wordsUpper}}
 */

const Joi = require('joi');

const schema = {
    {{=it.m.fields.primary.names.wordsLower}}: Joi.{{=it.m.fields.primary.type}}().required()
}

/**
 * Add route to get {{=it.m.names.wordsUpper}}
 */
server.route({
    method: 'GET',
    path: `/{{=it.m.names.hyphen}}/{{{=it.m.fields.primary.names.underscore}}}`,
    config: {
       validate: {
           params: schema
       }
    },
    handler: (request, reply) => {

        // Get {{=it.m.names.wordsLower}} {{=it.m.fields.primary.names.wordsLower}}
        const {{=it.m.fields.primary.names.underscore}} = request.params.{{=it.m.fields.primary.names.underscore}};

        // Get object from database
        request.server.db.collection('{{=it.m.names.underscore}}')
          .find({ {{=it.m.fields.primary.names.raw}}: {{=it.m.fields.primary.names.underscore}} })
          .then((results) => {
              reply(results)
          })
          .catch(reply);
    }
});
</script>
